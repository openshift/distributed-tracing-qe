# OpenTelemetry Component End-to-End Test Suite

This directory contains comprehensive end-to-end tests for OpenTelemetry Collector components, providing **configuration blueprints** and **testing patterns** for customers to understand and deploy various OpenTelemetry receivers, processors, exporters, and extensions.

> **ğŸ“ Note**: The component README files in this directory were generated by Claude AI to provide comprehensive documentation and configuration examples based on the existing test cases.

## ğŸ¯ Purpose

These test scenarios provide OpenTelemetry component configuration blueprints that demonstrate:
- Individual component functionality and configuration
- Real-world deployment patterns for specific use cases
- Integration testing with Kubernetes and OpenShift
- Configuration examples for component setup and optimization

## ğŸ“‹ Component Test Categories

### ğŸ”„ Receivers
| Component | Purpose | Key Features |
|-----------|---------|-------------|
| [filelog](./filelog/) | File-based Log Collection | Pod log collection, file parsing, daemonset deployment |
| [hostmetricsreceiver](./hostmetricsreceiver/) | Host System Metrics | CPU, memory, disk, network metrics from nodes |
| [k8sclusterreceiver](./k8sclusterreceiver/) | Kubernetes Cluster Metrics | Cluster-wide metrics, pod/node status, resource usage |
| [k8seventsreceiver](./k8seventsreceiver/) | Kubernetes Events | Event collection, cluster monitoring, troubleshooting |
| [kubeletstatsreceiver](./kubeletstatsreceiver/) | Kubelet Statistics | Container metrics, pod resource usage, node stats |
| [k8sobjectsreceiver](./k8sobjectsreceiver/) | Kubernetes Object Monitoring | Custom resource monitoring, object state tracking |
| [journaldreceiver](./journaldreceiver/) | systemd Journal Logs | System log collection, journal parsing, node-level logs |
| [otlpjsonfilereceiver](./otlpjsonfilereceiver/) | OTLP JSON File Input | File-based OTLP data ingestion, batch processing |

### ğŸ”§ Processors
| Component | Purpose | Key Features |
|-----------|---------|-------------|
| [transformprocessor](./transformprocessor/) | Data Transformation | Field mapping, data enrichment, format conversion |
| [filterprocessor](./filterprocessor/) | Data Filtering | Selective data processing, noise reduction, cost optimization |
| [groupbyattrsprocessor](./groupbyattrsprocessor/) | Attribute Grouping | Data aggregation, resource optimization, cardinality reduction |
| [tailsamplingprocessor](./tailsamplingprocessor/) | Intelligent Sampling | Trace-based sampling, performance optimization, cost control |

### ğŸ“¤ Exporters
| Component | Purpose | Key Features |
|-----------|---------|-------------|
| [prometheusremotewriteexporter](./prometheusremotewriteexporter/) | Prometheus Integration | Remote write protocol, metrics export, monitoring integration |
| [awsxrayexporter](./awsxrayexporter/) | AWS X-Ray Integration | Distributed tracing, AWS cloud integration, service maps |
| [awscloudwatchlogsexporter](./awscloudwatchlogsexporter/) | AWS CloudWatch Logs | Log aggregation, AWS cloud logging, centralized monitoring |
| [loadbalancingexporter](./loadbalancingexporter/) | Load Balanced Export | High availability, traffic distribution, resilient telemetry |
| [googlemanagedprometheus](./googlemanagedprometheus/) | Google Cloud Monitoring | GCP integration, managed Prometheus, cloud-native monitoring |

### ğŸ”— Connectors
| Component | Purpose | Key Features |
|-----------|---------|-------------|
| [routingconnector](./routingconnector/) | Data Routing | Conditional routing, multi-destination, intelligent forwarding |
| [forwardconnector](./forwardconnector/) | Data Forwarding | Pipeline chaining, data flow control, routing flexibility |
| [countconnector](./countconnector/) | Metric Generation | Data counting, statistics generation, monitoring insights |

### ğŸ”Œ Extensions
| Component | Purpose | Key Features |
|-----------|---------|-------------|
| [oidcauthextension](./oidcauthextension/) | OIDC Authentication | Secure authentication, identity integration, access control |
| [filestorageext](./filestorageext/) | File-based Storage | Persistent queuing, data buffering, reliability enhancement |

## ğŸš€ Quick Start

### Prerequisites

- Kubernetes or OpenShift cluster
- OpenTelemetry Operator installed
- `kubectl` or `oc` CLI tool configured
- [Chainsaw](https://kyverno.github.io/chainsaw/) for running tests

### Running Tests

```bash
# Run all component tests
chainsaw test --test-dir tests/e2e-otel/

# Run specific component test
chainsaw test --test-dir tests/e2e-otel/filelog/

# Run tests with specific configuration
chainsaw test --test-dir tests/e2e-otel/k8sclusterreceiver/ --config chainsaw-config.yaml
```

### Using as Configuration Templates

Each test directory contains:
- **Production-ready configurations**: YAML manifests for real deployments
- **Test scenarios**: Validation and verification examples
- **Documentation**: Component-specific usage guidance
- **Scripts**: Automated verification and helper tools

## ğŸ—ï¸ Test Structure

Each component test follows a consistent structure:

```
component-name/
â”œâ”€â”€ README.md                           # Component-specific documentation
â”œâ”€â”€ chainsaw-test.yaml                  # Chainsaw test definition
â”œâ”€â”€ otel-collector.yaml                 # OpenTelemetry Collector configuration
â”œâ”€â”€ otel-collector-assert.yaml          # Test assertions
â”œâ”€â”€ check_logs.sh                       # Verification script
â”œâ”€â”€ additional-resources.yaml           # Supporting resources
â””â”€â”€ additional-resources-assert.yaml    # Resource assertions
```

## ğŸ”§ Configuration Patterns

### Common Component Configurations

1. **RBAC Setup**
   - Service accounts and permissions
   - Cluster roles for cross-namespace access
   - Security context constraints for OpenShift

2. **Resource Management**
   - CPU and memory limits
   - Storage configurations
   - Network policies

3. **Data Processing**
   - Input validation and parsing
   - Transformation and enrichment
   - Output formatting and routing

4. **Monitoring Integration**
   - Health checks and status monitoring
   - Performance metrics collection
   - Alerting and notification setup

## ğŸ“Š Component Categories by Use Case

### ğŸ“ˆ Metrics Collection
- **Infrastructure**: `hostmetricsreceiver`, `kubeletstatsreceiver`
- **Application**: `k8sclusterreceiver`, `k8sobjectsreceiver`
- **Export**: `prometheusremotewriteexporter`, `googlemanagedprometheus`

### ğŸ“ Log Management
- **Collection**: `filelog`, `journaldreceiver`
- **Processing**: `transformprocessor`, `filterprocessor`
- **Export**: `awscloudwatchlogsexporter`

### ğŸ” Distributed Tracing
- **Collection**: `otlpjsonfilereceiver`
- **Processing**: `tailsamplingprocessor`, `groupbyattrsprocessor`
- **Export**: `awsxrayexporter`, `loadbalancingexporter`

### ğŸ”„ Data Pipeline
- **Routing**: `routingconnector`, `forwardconnector`
- **Transformation**: `transformprocessor`
- **Reliability**: `filestorageext`, `loadbalancingexporter`

## ğŸ›¡ï¸ Security and Authentication

Components with security features:
- **Authentication**: `oidcauthextension`
- **Access Control**: RBAC configurations in receiver components
- **Secure Communication**: TLS configurations in exporter components

## ğŸ“š Learning Path

### Beginner
1. Start with basic receivers: `hostmetricsreceiver`, `filelog`
2. Learn filtering and transformation: `filterprocessor`, `transformprocessor`
3. Explore simple exporters: `prometheusremotewriteexporter`

### Intermediate
1. Kubernetes integration: `k8sclusterreceiver`, `k8seventsreceiver`
2. Advanced processing: `tailsamplingprocessor`, `groupbyattrsprocessor`
3. Load balancing and routing: `loadbalancingexporter`, `routingconnector`

### Advanced
1. Cloud integrations: `awsxrayexporter`, `googlemanagedprometheus`
2. Authentication and security: `oidcauthextension`
3. Custom data flows: `forwardconnector`, `countconnector`

## ğŸ” Testing and Validation

Each component test includes:
- **Functional validation**: Component operation verification
- **Data flow testing**: Input/output validation
- **Performance testing**: Resource usage monitoring
- **Integration testing**: Multi-component scenarios

## ğŸ¤ Contributing

When adding new component tests:
1. Follow the established directory structure
2. Include comprehensive README documentation
3. Provide example configurations
4. Add verification scripts and assertions
5. Document component-specific considerations

## ğŸ“– Additional Resources

- [OpenTelemetry Collector Documentation](https://opentelemetry.io/docs/collector/)
- [OpenTelemetry Operator](https://github.com/open-telemetry/opentelemetry-operator)
- [Chainsaw Testing Framework](https://kyverno.github.io/chainsaw/)
- [OpenTelemetry Component Registry](https://opentelemetry.io/ecosystem/registry/) 